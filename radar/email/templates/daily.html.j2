<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OSS Radar Daily Intel</title>
  <style>
    /* â”€â”€ shadcn/ui zinc dark palette â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    body {
      margin: 0; padding: 0;
      background: #09090b;
      color: #fafafa;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      font-size: 14px;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }
    a { color: #fafafa; text-decoration: underline; text-decoration-color: #3f3f46; text-underline-offset: 4px; }
    a:hover { text-decoration-color: #a1a1aa; }

    .wrapper { max-width: 600px; margin: 0 auto; padding: 40px 20px; }

    /* â”€â”€ Header â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .header {
      text-align: center;
      padding: 48px 32px 40px;
      margin-bottom: 32px;
      border-bottom: 1px solid #27272a;
    }
    .header-icon {
      font-size: 48px;
      display: block;
      margin-bottom: 16px;
    }
    .header h1 {
      margin: 0 0 8px;
      font-size: 30px;
      font-weight: 700;
      letter-spacing: -0.6px;
      color: #fafafa;
    }
    .header .subtitle {
      color: #a1a1aa;
      font-size: 14px;
      margin: 0;
    }
    .header .subtitle strong {
      color: #fafafa;
      font-weight: 600;
    }

    /* â”€â”€ Stats row â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .stats-card {
      background: #18181b;
      border: 1px solid #27272a;
      border-radius: 12px;
      padding: 4px;
      margin-bottom: 24px;
    }
    .stats-table {
      width: 100%;
      border-collapse: collapse;
    }
    .stats-table td {
      text-align: center;
      padding: 16px 8px;
      width: 25%;
    }
    .stat-value {
      font-size: 28px;
      font-weight: 700;
      color: #fafafa;
      display: block;
      line-height: 1;
      letter-spacing: -0.5px;
    }
    .stat-label {
      font-size: 11px;
      font-weight: 500;
      color: #71717a;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: block;
      margin-top: 6px;
    }
    .stat-divider {
      width: 1px;
      background: #27272a;
    }

    /* â”€â”€ Partial banner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .partial-banner {
      background: #18181b;
      border: 1px solid #422006;
      border-radius: 12px;
      padding: 16px 20px;
      margin-bottom: 24px;
      color: #fbbf24;
      font-size: 14px;
      line-height: 1.5;
    }
    .partial-banner strong { color: #fde68a; }

    /* â”€â”€ Entry card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .entry {
      background: #18181b;
      border: 1px solid #27272a;
      border-radius: 12px;
      margin-bottom: 12px;
      overflow: hidden;
      transition: border-color 0.15s;
    }
    .entry:hover { border-color: #3f3f46; }

    .entry-inner { padding: 24px; }

    /* Rank + Score top bar */
    .entry-topbar {
      margin-bottom: 12px;
    }
    .entry-topbar table { width: 100%; border-collapse: collapse; }
    .rank-pill {
      display: inline-block;
      background: #27272a;
      color: #a1a1aa;
      font-size: 12px;
      font-weight: 700;
      padding: 4px 12px;
      border-radius: 9999px;
      letter-spacing: 0.3px;
    }
    .entry-rank-1 .rank-pill { background: #422006; color: #fbbf24; }
    .entry-rank-2 .rank-pill { background: #27272a; color: #d4d4d8; }
    .entry-rank-3 .rank-pill { background: #292524; color: #d6956b; }

    .score-pill {
      display: inline-block;
      background: #09090b;
      border: 1px solid #27272a;
      color: #fafafa;
      font-size: 13px;
      font-weight: 600;
      padding: 4px 12px;
      border-radius: 9999px;
      font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
      letter-spacing: -0.3px;
    }

    /* Title */
    .entry-title {
      font-size: 18px;
      font-weight: 600;
      color: #fafafa;
      line-height: 1.4;
      margin-bottom: 14px;
      letter-spacing: -0.2px;
    }
    .entry-title a { color: #fafafa; text-decoration: none; }
    .entry-title a:hover { text-decoration: underline; text-decoration-color: #52525b; text-underline-offset: 4px; }

    /* Tags */
    .entry-tags {
      margin-bottom: 16px;
      line-height: 2;
    }
    .tag {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      margin-right: 4px;
      margin-bottom: 4px;
    }

    /* Platform â€” distinct colors */
    .tag-reddit { background: #2a1508; color: #fb923c; }
    .tag-hackernews { background: #27200a; color: #facc15; }
    .tag-devto { background: #1e1533; color: #c084fc; }
    .tag-lobsters { background: #2a0a0a; color: #f87171; }
    .tag-platform { background: #172554; color: #60a5fa; }

    /* Tier */
    .tag-live { background: #052e16; color: #4ade80; }
    .tag-archive7d { background: #1c1917; color: #a8a29e; }
    .tag-archive30d { background: #1e1533; color: #a78bfa; }
    .tag-partial { background: #2a0a0a; color: #f87171; }

    /* Pain category */
    .tag-pain {
      background: #09090b;
      color: #a1a1aa;
      border: 1px solid #27272a;
    }

    /* Body excerpt */
    .entry-body {
      color: #a1a1aa;
      font-size: 14px;
      line-height: 1.65;
      padding-top: 16px;
      border-top: 1px solid #27272a;
    }

    /* â”€â”€ Footer â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    .footer {
      text-align: center;
      margin-top: 40px;
      padding-top: 24px;
      border-top: 1px solid #27272a;
    }
    .footer p {
      color: #52525b;
      font-size: 13px;
      margin: 0 0 4px;
    }
    .footer a { color: #71717a; font-size: 12px; }

    /* â”€â”€ Light mode â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    @media (prefers-color-scheme: light) {
      body { background: #ffffff; color: #09090b; }
      .header { border-bottom-color: #e4e4e7; }
      .header h1 { color: #09090b; }
      .header .subtitle { color: #71717a; }
      .header .subtitle strong { color: #09090b; }
      .stats-card { background: #fafafa; border-color: #e4e4e7; }
      .stat-value { color: #09090b; }
      .stat-label { color: #71717a; }
      .stat-divider { background: #e4e4e7; }
      .entry { background: #fafafa; border-color: #e4e4e7; }
      .entry:hover { border-color: #d4d4d8; }
      .entry-title, .entry-title a { color: #09090b; }
      .score-pill { background: #ffffff; border-color: #e4e4e7; color: #09090b; }
      .rank-pill { background: #f4f4f5; color: #52525b; }
      .entry-rank-1 .rank-pill { background: #fef3c7; color: #92400e; }
      .tag-pain { background: #fafafa; color: #52525b; border-color: #e4e4e7; }
      .entry-body { color: #52525b; border-top-color: #e4e4e7; }
      .partial-banner { background: #fffbeb; border-color: #fde68a; color: #92400e; }
      .partial-banner strong { color: #78350f; }
      .footer { border-top-color: #e4e4e7; }
      a { color: #09090b; text-decoration-color: #d4d4d8; }
    }
  </style>
</head>
<body>
<div class="wrapper">

  <!-- Header -->
  <div class="header">
    <span class="header-icon">ğŸ›°ï¸</span>
    <h1>OSS Radar Daily Intel</h1>
    <p class="subtitle">{{ date_str }} &nbsp;Â·&nbsp; <strong>{{ report.entry_count }}</strong> signal{{ 's' if report.entry_count != 1 else '' }} detected</p>
  </div>

  <!-- Stats -->
  <div class="stats-card">
    <table class="stats-table">
      <tr>
        <td>
          <span class="stat-value">{{ report.total_collected or 0 }}</span>
          <span class="stat-label">Collected</span>
        </td>
        <td class="stat-divider"></td>
        <td>
          <span class="stat-value">{{ report.total_after_filter or 0 }}</span>
          <span class="stat-label">Filtered</span>
        </td>
        <td class="stat-divider"></td>
        <td>
          <span class="stat-value">{{ report.entry_count }}</span>
          <span class="stat-label">Reported</span>
        </td>
        <td class="stat-divider"></td>
        <td>
          {% set scraper_count = report.scraper_statuses | length if report.scraper_statuses else 0 %}
          <span class="stat-value">{{ scraper_count }}</span>
          <span class="stat-label">Sources</span>
        </td>
      </tr>
    </table>
  </div>

  {% if report.is_partial %}
  <div class="partial-banner">
    âš ï¸ <strong>Partial report</strong> â€” fewer than 5 qualifying signals found. Backfill from archived data was used.
  </div>
  {% endif %}

  <!-- Entries -->
  {% set entries = report.entries or report.top_posts %}
  {% for post in entries %}
  {% set rank = loop.index %}
  <div class="entry entry-rank-{{ rank }}">
    <div class="entry-inner">

      <!-- Rank + Score -->
      <div class="entry-topbar">
        <table><tr>
          <td style="text-align:left;">
            <span class="rank-pill">#{{ rank }}</span>
          </td>
          <td style="text-align:right;">
            <span class="score-pill">{{ "%.2f"|format(post.final_score or post.signal_score) }}</span>
          </td>
        </tr></table>
      </div>

      <!-- Title -->
      <div class="entry-title">
        <a href="{{ post.url }}">{{ post.title | truncate(90) }}</a>
      </div>

      <!-- Tags -->
      <div class="entry-tags">
        {% set p = post.platform | lower %}
        {% if p == 'reddit' %}
          <span class="tag tag-reddit">{{ post.platform }}</span>
        {% elif p in ('hackernews', 'hacker_news', 'hn') %}
          <span class="tag tag-hackernews">{{ post.platform }}</span>
        {% elif p in ('devto', 'dev.to', 'dev') %}
          <span class="tag tag-devto">{{ post.platform }}</span>
        {% elif p == 'lobsters' %}
          <span class="tag tag-lobsters">{{ post.platform }}</span>
        {% else %}
          <span class="tag tag-platform">{{ post.platform }}</span>
        {% endif %}

        {% set tier = post.source_tier or post.backfill_source or 'live' %}
        {% if tier == 'live' %}
          <span class="tag tag-live">live</span>
        {% elif tier == 'archive-7d' or tier == 'archive_7d' %}
          <span class="tag tag-archive7d">archive Â· 7d</span>
        {% elif tier == 'archive-30d' or tier == 'archive_30d' %}
          <span class="tag tag-archive30d">archive Â· 30d</span>
        {% else %}
          <span class="tag tag-partial">partial</span>
        {% endif %}

        {% for cat in post.pain_categories[:3] %}
          <span class="tag tag-pain">{{ (cat.value if cat.value is defined else cat) | replace('_', ' ') }}</span>
        {% endfor %}
      </div>

      <!-- Body -->
      {% if post.llm_summary %}
      <div class="entry-body">{{ post.llm_summary }}</div>
      {% else %}
      {% set excerpt = (post.body or '')[:220] %}
      {% if excerpt %}
      <div class="entry-body">{{ excerpt }}{% if (post.body or '') | length > 220 %}â€¦{% endif %}</div>
      {% endif %}
      {% endif %}

    </div>
  </div>
  {% else %}
  <div class="entry">
    <div class="entry-inner" style="text-align:center; color:#52525b; padding:40px 24px;">
      No qualifying signals found for this period.
    </div>
  </div>
  {% endfor %}

  <!-- Footer -->
  <div class="footer">
    <p>ğŸ›°ï¸ OSS Radar Â· Autonomous Signal Intelligence</p>
    <p><a href="https://github.com/DUBSOpenHub/ghost-ops">Powered by Ghost Ops</a></p>
  </div>

</div>
</body>
</html>
